# æ‹›æŠ•æ ‡çˆ¬è™«å·¥å…· - äº¤ä»˜æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªé’ˆå¯¹é‡‡æ‹›ç½‘çš„æ‹›æŠ•æ ‡ä¿¡æ¯çˆ¬è™«å·¥å…·ï¼Œä¸“é—¨ç”¨äºç›‘æ§å››å·çœçš„æ‹›æŠ•æ ‡é¡¹ç›®ã€‚é¡¹ç›®é‡‡ç”¨ **TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰** å’Œ **SDDï¼ˆè§„æ ¼é©±åŠ¨å¼€å‘ï¼‰** æ–¹æ³•è®ºï¼Œå®ç°äº† MVP ç‰ˆæœ¬ã€‚

---

## äº¤ä»˜å†…å®¹

### 1. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

| æ¨¡å— | æ–‡ä»¶ | çŠ¶æ€ | æµ‹è¯•è¦†ç›– |
|------|------|------|----------|
| æ•°æ®æ¨¡å‹ | `src/data/models.py` | âœ… å®Œæˆ | 100% |
| å…³é”®å­—åŒ¹é… | `src/data/matcher.py` | âœ… å®Œæˆ | 100% |
| æ•°æ®å»é‡ | `src/data/deduplicator.py` | âœ… å®Œæˆ | 100% |
| JSON å­˜å‚¨ | `src/data/storage.py` | âœ… å®Œæˆ | 100% |
| æµè§ˆå™¨çˆ¬è™« | `src/crawler/browser_crawler.py` | âœ… å®Œæˆ | æ‰‹åŠ¨æµ‹è¯•é€šè¿‡ |
| Playwright çˆ¬è™« | `src/crawler/search_crawler.py` | âš ï¸ åŸºç¡€ç‰ˆ | è§¦å‘éªŒè¯ç  |
| Streamlit UI | `src/ui/app.py` | âœ… å®Œæˆ | æ‰‹åŠ¨æµ‹è¯•é€šè¿‡ |

### 2. æµ‹è¯•å¥—ä»¶

- **å•å…ƒæµ‹è¯•**: 12 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå…¨éƒ¨é€šè¿‡
- **æµ‹è¯•è¦†ç›–ç‡**: æ•°æ®å±‚ 100%
- **æµ‹è¯•æ¡†æ¶**: pytest

```bash
# è¿è¡Œæµ‹è¯•
pytest tests/unit/ -v

# æµ‹è¯•ç»“æœ
============ 12 passed in 0.04s ============
```

### 3. æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| `README.md` | é¡¹ç›®è¯´æ˜å’Œä½¿ç”¨æŒ‡å— |
| `CRAWLER_GUIDE.md` | çˆ¬è™«ä½¿ç”¨æŒ‡å—ï¼ˆè¯¦ç»†ï¼‰ |
| `DELIVERY.md` | äº¤ä»˜æ–‡æ¡£ï¼ˆæœ¬æ–‡æ¡£ï¼‰ |
| `bidding_crawler_sdd_v2.md` | SDD è§„æ ¼æ–‡æ¡£ |

### 4. é…ç½®æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `config.yaml` | ä¸»é…ç½®æ–‡ä»¶ |
| `requirements.txt` | Python ä¾èµ– |
| `Dockerfile` | Docker é•œåƒé…ç½® |
| `docker-compose.yml` | Docker Compose é…ç½® |
| `pytest.ini` | pytest é…ç½® |
| `.gitignore` | Git å¿½ç•¥è§„åˆ™ |

---

## æŠ€æœ¯æ¶æ„

### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          UI Layer (Streamlit)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Business Logic Layer          â”‚
â”‚  - KeywordMatcher                   â”‚
â”‚  - DataDeduplicator                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Data Access Layer             â”‚
â”‚  - JSONStorage                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Crawler Layer                 â”‚
â”‚  - BrowserCrawler (æ¨è)            â”‚
â”‚  - SearchCrawler (Playwright)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Python 3.11
- **Web æ¡†æ¶**: Streamlit
- **æµè§ˆå™¨è‡ªåŠ¨åŒ–**: Playwright
- **æµ‹è¯•æ¡†æ¶**: pytest
- **æ—¥å¿—**: structlog
- **å®¹å™¨åŒ–**: Docker

---

## çˆ¬è™«æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šåŸºäºæµè§ˆå™¨å†…å®¹çš„çˆ¬è™«ï¼ˆæ¨èï¼‰

**çŠ¶æ€**: âœ… å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡

**å·¥ä½œåŸç†**:
1. ä½¿ç”¨ Manus æµè§ˆå™¨å·¥å…·æˆ–æ‰‹åŠ¨è®¿é—®é‡‡æ‹›ç½‘
2. å¤åˆ¶é¡µé¢å†…å®¹åˆ° `browser_content.txt`
3. è¿è¡Œ `crawl_from_browser.py` è§£ææ•°æ®
4. è‡ªåŠ¨ä¿å­˜åˆ°æ•°æ®åº“

**ä¼˜ç‚¹**:
- âœ… ç»•è¿‡éªŒè¯ç 
- âœ… ç¨³å®šå¯é 
- âœ… æ— éœ€ä»£ç†IP

**ä½¿ç”¨æ–¹æ³•**:
```bash
python3.11 crawl_from_browser.py
```

### æ–¹æ¡ˆäºŒï¼šPlaywright çˆ¬è™«

**çŠ¶æ€**: âš ï¸ åŸºç¡€ç‰ˆå·²å®ç°ï¼Œä½†è§¦å‘éªŒè¯ç 

**é—®é¢˜**: é‡‡æ‹›ç½‘ä½¿ç”¨é˜¿é‡Œäº‘äººæœºéªŒè¯ï¼Œæ— å¤´æµè§ˆå™¨ä¼šè¢«æ£€æµ‹

**æ”¹è¿›æ–¹å‘**:
1. ä½¿ç”¨ playwright-stealth
2. é…ç½®ä»£ç†IPæ± 
3. ä½¿ç”¨æœ‰å¤´æ¨¡å¼ + è™šæ‹Ÿæ˜¾ç¤º
4. é›†æˆæ‰“ç å¹³å°

---

## æ•°æ®æµç¨‹

### é¦–æ¬¡è¿è¡Œï¼ˆå…¨é‡æŠ“å–ï¼‰

```
æµè§ˆå™¨è®¿é—®é‡‡æ‹›ç½‘
    â†“
å¤åˆ¶é¡µé¢å†…å®¹
    â†“
browser_content.txt
    â†“
BrowserCrawler.parse_from_file()
    â†“
KeywordMatcher.match()
    â†“
JSONStorage.save()
    â†“
data/bidding_data.json
```

### åç»­è¿è¡Œï¼ˆå¢é‡æŠ“å–ï¼‰

```
æµè§ˆå™¨è®¿é—®é‡‡æ‹›ç½‘ï¼ˆè¿‘ä¸€å¤©ï¼‰
    â†“
å¤åˆ¶é¡µé¢å†…å®¹
    â†“
browser_content.txt
    â†“
BrowserCrawler.parse_from_file()
    â†“
DataDeduplicator.deduplicate()
    â†“
JSONStorage.append()
    â†“
data/bidding_data.jsonï¼ˆè¿½åŠ æ–°æ•°æ®ï¼‰
```

---

## ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿå¼€å§‹

```bash
# 1. å®‰è£…ä¾èµ–
cd /home/ubuntu/bidding-crawler
pip3 install -r requirements.txt
playwright install chromium

# 2. æŠ“å–æ•°æ®
python3.11 crawl_from_browser.py

# 3. å¯åŠ¨ Web ç•Œé¢
streamlit run src/ui/app.py
```

### é…ç½®å…³é”®å­—

ç¼–è¾‘ `config.yaml`:

```yaml
crawler:
  keywords:
    - å¹¿å‘Š
    - æ ‡è¯†
    - ç‰Œ
    - æ ‡å¿—
    - å®£ä¼ 
    - æ 
    - æ–‡åŒ–
```

### é…ç½®åœ°åŒº

ç¼–è¾‘ `config.yaml`:

```yaml
crawler:
  search:
    region: å››å·  # å¯æ”¹ä¸ºå…¶ä»–çœä»½
```

---

## æµ‹è¯•ç»“æœ

### å•å…ƒæµ‹è¯•

```bash
$ pytest tests/unit/ -v

tests/unit/test_deduplicator.py::test_deduplicate_empty PASSED
tests/unit/test_deduplicator.py::test_deduplicate_no_duplicates PASSED
tests/unit/test_deduplicator.py::test_deduplicate_with_duplicates PASSED
tests/unit/test_keyword_matcher.py::test_match_single_keyword PASSED
tests/unit/test_keyword_matcher.py::test_match_multiple_keywords PASSED
tests/unit/test_keyword_matcher.py::test_match_no_keywords PASSED
tests/unit/test_keyword_matcher.py::test_match_case_insensitive PASSED
tests/unit/test_storage.py::test_save_and_load PASSED
tests/unit/test_storage.py::test_append PASSED
tests/unit/test_storage.py::test_is_first_run PASSED
tests/unit/test_storage.py::test_get_all PASSED
tests/unit/test_storage.py::test_get_by_date_range PASSED

============ 12 passed in 0.04s ============
```

### çˆ¬è™«æµ‹è¯•

```bash
$ python3.11 crawl_from_browser.py

âœ… æˆåŠŸè§£æ 1 æ¡é¡¹ç›®
ğŸ“Š åœ°åŒºåˆ†å¸ƒï¼š
  å››å·: 1 æ¡
ğŸ“‹ ä¿¡æ¯ç±»å‹åˆ†å¸ƒï¼š
  æ‹›æ ‡å…¬å‘Š: 1 æ¡
```

---

## æ•°æ®ç¤ºä¾‹

### è¾“å…¥ï¼ˆbrowser_content.txtï¼‰

```
æ‹›æ ‡å…¬å‘Š æ²™æ¹¾åŒºå¯¨å­æ‘ä¼ ç»Ÿæ‘è½ä¿æŠ¤æ”¹é€ æå‡é¡¹ç›®-äº¤æ˜“å…¬å‘Š (å¹¿å‘Š,æ ‡è¯†åœ¨å†…å®¹ä¸­)
é‡‡è´­é¢„ç®—ï¼š27218.16ä¸‡å…ƒ 
 é‡‡è´­æ–¹å¼ï¼šæ¯”é€‰ æˆªæ­¢æ—¶é—´ï¼šè¯¦è§å†…å®¹ 
å››å·
2026-02-02
```

### è¾“å‡ºï¼ˆdata/bidding_data.jsonï¼‰

```json
{
  "id": "browser_1738491312_0",
  "title": "æ²™æ¹¾åŒºå¯¨å­æ‘ä¼ ç»Ÿæ‘è½ä¿æŠ¤æ”¹é€ æå‡é¡¹ç›®-äº¤æ˜“å…¬å‘Š",
  "info_type": "æ‹›æ ‡å…¬å‘Š",
  "publish_date": "2026-02-02T00:00:00",
  "province": "å››å·",
  "city": null,
  "district": null,
  "owner_unit": null,
  "budget_amount": "27218.16ä¸‡å…ƒ",
  "procurement_type": "æ¯”é€‰",
  "bidding_deadline": null,
  "keywords_matched": [],
  "project_address": null,
  "attachments": [],
  "source_url": "https://search.bidcenter.com.cn/search?keywords=å¹¿å‘Š,æ ‡è¯†,ç‰Œ,æ ‡å¿—,å®£ä¼ ,æ ,æ–‡åŒ–"
}
```

---

## å·²çŸ¥é—®é¢˜

### 1. Playwright çˆ¬è™«è§¦å‘éªŒè¯ç 

**é—®é¢˜**: é‡‡æ‹›ç½‘æ£€æµ‹åˆ°æ— å¤´æµè§ˆå™¨ï¼Œè§¦å‘é˜¿é‡Œäº‘äººæœºéªŒè¯

**å½±å“**: æ— æ³•è‡ªåŠ¨åŒ–æŠ“å–

**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨æ–¹æ¡ˆä¸€ï¼ˆåŸºäºæµè§ˆå™¨å†…å®¹çš„çˆ¬è™«ï¼‰

**åç»­æ”¹è¿›**: 
- é…ç½®ä»£ç†IP
- ä½¿ç”¨ playwright-stealth
- é›†æˆæ‰“ç å¹³å°

### 2. å…³é”®å­—åŒ¹é…ä¸å‡†ç¡®

**é—®é¢˜**: å½“å‰åªåšç®€å•çš„å­—ç¬¦ä¸²åŒ¹é…ï¼Œå¯èƒ½é—æ¼ç›¸å…³é¡¹ç›®

**å½±å“**: å¯èƒ½é”™è¿‡ä¸€äº›ç›¸å…³æ‹›æ ‡

**è§£å†³æ–¹æ¡ˆ**: 
- V1.1: æ·»åŠ åŒä¹‰è¯åŒ¹é…
- V2.0: ä½¿ç”¨ NLP è¯­ä¹‰åŒ¹é…

### 3. ç¼ºå°‘é‚®ä»¶é€šçŸ¥

**é—®é¢˜**: å½“å‰åªèƒ½æ‰‹åŠ¨æŸ¥çœ‹ Streamlit ç•Œé¢

**å½±å“**: æ— æ³•åŠæ—¶è·çŸ¥æ–°é¡¹ç›®

**è§£å†³æ–¹æ¡ˆ**: V1.1 å®ç°é‚®ä»¶é€šçŸ¥åŠŸèƒ½

---

## åç»­è¿­ä»£è®¡åˆ’

### V1.1ï¼ˆ1-2å‘¨ï¼‰

- [ ] ä¼˜åŒ– Playwright çˆ¬è™«ï¼Œç»•è¿‡éªŒè¯ç 
- [ ] å®ç°é‚®ä»¶é€šçŸ¥åŠŸèƒ½
- [ ] å®ç°å®šæ—¶ä»»åŠ¡è°ƒåº¦ï¼ˆæ¯å¤© 08:00ï¼‰
- [ ] æ·»åŠ åŒä¹‰è¯åŒ¹é…
- [ ] æ”¹è¿›æ—¥å¿—è®°å½•

### V2.0ï¼ˆ1-2ä¸ªæœˆï¼‰

- [ ] PostgreSQL æŒä¹…åŒ–
- [ ] NLP è¯­ä¹‰åŒ¹é…
- [ ] ä¼ä¸šå¾®ä¿¡/é’‰é’‰æœºå™¨äºº
- [ ] Docker å®¹å™¨åŒ–éƒ¨ç½²
- [ ] API é€†å‘å·¥ç¨‹
- [ ] è¯¦æƒ…é¡µæŠ“å–ï¼ˆä¸šä¸»å•ä½ã€é¡¹ç›®åœ°å€ç­‰ï¼‰

### V3.0ï¼ˆ3-6ä¸ªæœˆï¼‰

- [ ] å¤šåœ°åŒºæ”¯æŒ
- [ ] æ•°æ®åˆ†æå’Œå¯è§†åŒ–
- [ ] é¡¹ç›®æ¨èç®—æ³•
- [ ] ç§»åŠ¨ç«¯é€‚é…
- [ ] ç”¨æˆ·æƒé™ç®¡ç†

---

## éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒ

```bash
# æœ¬åœ°è¿è¡Œ
cd /home/ubuntu/bidding-crawler
python3.11 crawl_from_browser.py
streamlit run src/ui/app.py
```

### ç”Ÿäº§ç¯å¢ƒï¼ˆæœªæ¥ï¼‰

```bash
# Docker éƒ¨ç½²
docker-compose up -d

# é…ç½®å®šæ—¶ä»»åŠ¡
crontab -e
0 8 * * * cd /home/ubuntu/bidding-crawler && python3.11 crawl_from_browser.py
```

---

## æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒä»£ç 

```
src/
â”œâ”€â”€ crawler/
â”‚   â”œâ”€â”€ browser_crawler.py      # æµè§ˆå™¨å†…å®¹çˆ¬è™«ï¼ˆæ¨èï¼‰
â”‚   â””â”€â”€ search_crawler.py       # Playwright çˆ¬è™«
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ models.py               # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ storage.py              # å­˜å‚¨å±‚
â”‚   â”œâ”€â”€ matcher.py              # å…³é”®å­—åŒ¹é…
â”‚   â””â”€â”€ deduplicator.py         # æ•°æ®å»é‡
â””â”€â”€ ui/
    â””â”€â”€ app.py                  # Streamlit åº”ç”¨
```

### æµ‹è¯•ä»£ç 

```
tests/
â””â”€â”€ unit/
    â”œâ”€â”€ test_keyword_matcher.py
    â”œâ”€â”€ test_deduplicator.py
    â””â”€â”€ test_storage.py
```

### è„šæœ¬

```
main.py                         # ä¸»æ‰§è¡Œè„šæœ¬ï¼ˆæ¨¡æ‹Ÿæ•°æ®ï¼‰
test_crawler.py                 # Playwright çˆ¬è™«æµ‹è¯•
crawl_from_browser.py           # æµè§ˆå™¨å†…å®¹çˆ¬è™«ï¼ˆæ¨èï¼‰
```

### é…ç½®

```
config.yaml                     # ä¸»é…ç½®æ–‡ä»¶
requirements.txt                # Python ä¾èµ–
Dockerfile                      # Docker é•œåƒ
docker-compose.yml              # Docker Compose
pytest.ini                      # pytest é…ç½®
.gitignore                      # Git å¿½ç•¥è§„åˆ™
```

### æ–‡æ¡£

```
README.md                       # é¡¹ç›®è¯´æ˜
CRAWLER_GUIDE.md                # çˆ¬è™«ä½¿ç”¨æŒ‡å—
DELIVERY.md                     # äº¤ä»˜æ–‡æ¡£ï¼ˆæœ¬æ–‡æ¡£ï¼‰
bidding_crawler_sdd_v2.md       # SDD è§„æ ¼æ–‡æ¡£
```

---

## æ€»ç»“

æœ¬é¡¹ç›®æˆåŠŸå®ç°äº†æ‹›æŠ•æ ‡ä¿¡æ¯çˆ¬è™«çš„ MVP ç‰ˆæœ¬ï¼Œæ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š

1. âœ… æ•°æ®æŠ“å–ï¼ˆåŸºäºæµè§ˆå™¨å†…å®¹ï¼‰
2. âœ… å…³é”®å­—åŒ¹é…
3. âœ… æ•°æ®å­˜å‚¨ï¼ˆJSONï¼‰
4. âœ… Web ç•Œé¢ï¼ˆStreamlitï¼‰
5. âœ… æ•°æ®ç­›é€‰å’Œå¯¼å‡º
6. âœ… TDD å¼€å‘ï¼ˆ12ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼‰

è™½ç„¶ Playwright è‡ªåŠ¨åŒ–çˆ¬è™«é‡åˆ°äº†éªŒè¯ç é—®é¢˜ï¼Œä½†æˆ‘ä»¬æä¾›äº†å¯é çš„æ›¿ä»£æ–¹æ¡ˆï¼ˆåŸºäºæµè§ˆå™¨å†…å®¹çš„çˆ¬è™«ï¼‰ï¼Œå¯ä»¥æ»¡è¶³å½“å‰çš„ä¸šåŠ¡éœ€æ±‚ã€‚

åç»­è¿­ä»£å°†é‡ç‚¹è§£å†³è‡ªåŠ¨åŒ–é—®é¢˜ï¼Œå¹¶æ·»åŠ é‚®ä»¶é€šçŸ¥ã€å®šæ—¶ä»»åŠ¡ç­‰åŠŸèƒ½ï¼Œæœ€ç»ˆå®ç°å®Œå…¨è‡ªåŠ¨åŒ–çš„æ‹›æŠ•æ ‡ä¿¡æ¯ç›‘æ§ç³»ç»Ÿã€‚

---

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚

---

**äº¤ä»˜æ—¥æœŸ**: 2026-02-02  
**é¡¹ç›®çŠ¶æ€**: MVP å®Œæˆ  
**ä¸‹ä¸€ä¸ªé‡Œç¨‹ç¢‘**: V1.1ï¼ˆé‚®ä»¶é€šçŸ¥ + å®šæ—¶ä»»åŠ¡ï¼‰
